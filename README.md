# Metric Collector API

–ü—Ä–æ—Å—Ç–æ–π –≤–µ–±-—Å–µ—Ä–≤–∏—Å –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫ –ø–æ—Å–µ—â–µ–Ω–∏–π, –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–ø–∞–∫–æ–≤–∞–Ω–Ω—ã–π –≤ Docker. –≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –æ—Ç –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∫–æ–¥–∞ –Ω–∞ Python –¥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é Docker –∏ Docker Compose.

## üöÄ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **–û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è:** Docker, Docker Compose
- **–ë—ç–∫–µ–Ω–¥:** Python 3.11, FastAPI
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL
- **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** Psycopg2, Pydantic, Uvicorn

---

## ‚ú® –ì–ª–∞–≤–Ω—ã–π —Å–ø–æ—Å–æ–± –∑–∞–ø—É—Å–∫–∞ (Docker)

–≠—Ç–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–ø–æ—Å–æ–± –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞. –í—Å–µ, —á—Ç–æ –≤–∞–º –Ω—É–∂–Ω–æ ‚Äî —ç—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π Docker –∏ Docker Compose.

1.  **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
    ```bash
    git clone https://github.com/–í–ê–®_–ù–ò–ö/metric-collector-project.git
    cd metric-collector-project
    ```

2.  **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
    –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —à–∞–±–ª–æ–Ω `.env.example` –≤ –Ω–æ–≤—ã–π —Ñ–∞–π–ª `.env` –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è (—Ö–æ—Ç—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–æ–¥–æ–π–¥—É—Ç –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞).
    ```bash
    cp .env.example .env
    ```

3.  **–°–æ–±–µ—Ä–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:**
    ```bash
    docker-compose up --build
    ```
    –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —Å–∫–∞—á–∞–µ—Ç –æ–±—Ä–∞–∑ PostgreSQL, —Å–æ–±–µ—Ä–µ—Ç –æ–±—Ä–∞–∑ –¥–ª—è Python-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –∑–∞–ø—É—Å—Ç–∏—Ç –æ–±–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

4.  **–ü—Ä–æ–≤–µ—Ä–∫–∞:**
    –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É `http://127.0.0.1:8000`.
    –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API (Swagger UI) –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø–æ –∞–¥—Ä–µ—Å—É [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs).

5.  **–û—Å—Ç–∞–Ω–æ–≤–∫–∞:**
    –ù–∞–∂–º–∏—Ç–µ `Ctrl+C` –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, –≥–¥–µ –∑–∞–ø—É—â–µ–Ω `docker-compose`, –∞ –∑–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
    ```bash
    docker-compose down
    ```

---

## üìù API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

- `POST /visit` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤—ã–π –≤–∏–∑–∏—Ç.
  - **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:** `{"page_url": "string"}`
- `GET /stats` ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –≤–∏–∑–∏—Ç–æ–≤.

---

### (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –±–µ–∑ Docker

–≠—Ç–æ—Ç —Å–ø–æ—Å–æ–± —Ç—Ä–µ–±—É–µ—Ç —Ä—É—á–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Python 3.11+ –∏ PostgreSQL –Ω–∞ –≤–∞—à—É –º–∞—à–∏–Ω—É.

1.  –°–æ–∑–¥–∞–π—Ç–µ –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ.
2.  –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `pip install -r requirements.txt`.
3.  –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä PostgreSQL –∑–∞–ø—É—â–µ–Ω.
4.  –í —Ñ–∞–π–ª–µ `.env` —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `DB_HOST="localhost"`.
5.  –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: `python -m uvicorn app.main:app --reload`.